<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Read, Write, Plot and Analyze MTG (Mutli-Scale Tree Graph) Files • XploRer</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Read, Write, Plot and Analyze MTG (Mutli-Scale Tree Graph) Files">
<meta property="og:description" content="Manage plant topology data from MTG files. ">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">XploRer</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.6.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="xplorer" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#xplorer" class="anchor"></a>XploRer</h1></div>
<!-- badges: start -->

<p>The goal of XploRer is to read, write, analyze and plot MTG (Multi-scale Tree Graph) files. These files describe the plant topology (i.e. structure) along with some attributes for each node (e.g. geometry, colors, state…).</p>
<blockquote>
<p>The package is under intensive development and is in a very early version. The functions may heavily change from one version to another until a more stable version is released.</p>
</blockquote>
<div id="table-of-contents" class="section level2">
<h2 class="hasAnchor">
<a href="#table-of-contents" class="anchor"></a>Table of Contents</h2>
<ul>
<li><a href="#1-installation">1. Installation</a></li>
<li>
<a href="#2-examples">2. Examples</a>
<ul>
<li><a href="#21-reading-a-file">2.1 Reading a file</a></li>
<li><a href="#22-mutate-the-mtg">2.2 Mutate</a></li>
<li><a href="#22-plotting-a-plant">2.3 Plot</a></li>
</ul>
</li>
<li><a href="#3-help">3. Help</a></li>
</ul>
</div>
<div id="1-installation" class="section level2">
<h2 class="hasAnchor">
<a href="#1-installation" class="anchor"></a>1. Installation</h2>
<p>you can install the release version of XploRer from <a href="https://github.com/">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="r"><span class="co"># install.packages("devtools")</span>
<span class="kw pkg">devtools</span><span class="kw ns">::</span><span class="fu">install_github</span>(<span class="st">"VEZY/XploRer"</span>)</pre></div>
</div>
<div id="2-examples" class="section level2">
<h2 class="hasAnchor">
<a href="#2-examples" class="anchor"></a>2. Examples</h2>
<div id="21-reading-a-file" class="section level3">
<h3 class="hasAnchor">
<a href="#21-reading-a-file" class="anchor"></a>2.1 Reading a file</h3>
<p>Read a simple MTG file:</p>
<div class="sourceCode" id="cb2"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">XploRer</span>)

<span class="no">MTG</span> <span class="kw">=</span> <span class="fu"><a href="reference/read_MTG.html">read_mtg</a></span>(<span class="st">"https://raw.githubusercontent.com/VEZY/XploRer/master/inst/extdata/simple_plant.mtg"</span>)</pre></div>
<p>The <code><a href="reference/read_MTG.html">read_mtg()</a></code> function returns a list of 4:</p>
<ul>
<li>
<p>classes: a <code>data.frame</code> that holds information about the type of nodes used in the MTG (e.g. Internode, Leaf, etc…), the MTG scale for each one, and some more details. Here is the classes <code>data.frame</code> from our example:</p>
<div class="sourceCode" id="cb3"><pre class="r"><span class="no">MTG</span>$<span class="no">classes</span>
<span class="co">#&gt;       SYMBOL SCALE DECOMPOSITION INDEXATION DEFINITION</span>
<span class="co">#&gt; 1          $     0          FREE       FREE   IMPLICIT</span>
<span class="co">#&gt; 2  Internode     6          FREE       FREE   IMPLICIT</span>
<span class="co">#&gt; 3 Individual     1          FREE       FREE   IMPLICIT</span>
<span class="co">#&gt; 4       Leaf     2          FREE       FREE   IMPLICIT</span>
<span class="co">#&gt; 5       Axis     2          FREE       FREE   IMPLICIT</span></pre></div>
</li>
<li>
<p>description: a <code>data.frame</code> defining the potential topological constraints existing between nodes. Here is the description <code>data.frame</code> from our example:</p>
<div class="sourceCode" id="cb4"><pre class="r"><span class="no">MTG</span>$<span class="no">description</span>
<span class="co">#&gt;        LEFT           RIGHT RELTYPE MAX</span>
<span class="co">#&gt; 1 Internode Internode, Leaf       +   ?</span>
<span class="co">#&gt; 2 Internode Internode, Leaf       &lt;   ?</span></pre></div>
</li>
<li>
<p>features: a <code>data.frame</code> listing all attributes present in the file and their associated type. Here is the features <code>data.frame</code> from our example:</p>
<div class="sourceCode" id="cb5"><pre class="r"><span class="no">MTG</span>$<span class="no">features</span>
<span class="co">#&gt;       NAME  TYPE</span>
<span class="co">#&gt; 1       XX  REAL</span>
<span class="co">#&gt; 2       YY  REAL</span>
<span class="co">#&gt; 3       ZZ  REAL</span>
<span class="co">#&gt; 4 FileName ALPHA</span>
<span class="co">#&gt; 5   Length ALPHA</span>
<span class="co">#&gt; 6    Width ALPHA</span>
<span class="co">#&gt; 7   XEuler  REAL</span></pre></div>
</li>
<li>
<p>MTG: a <code>data.tree</code> structure defining all nodes, their attributes and their relationships:</p>
<div class="sourceCode" id="cb6"><pre class="r"><span class="no">MTG</span>$<span class="no">MTG</span>
<span class="co">#&gt;                levelName</span>
<span class="co">#&gt; 1 node_1                </span>
<span class="co">#&gt; 2  °--node_2            </span>
<span class="co">#&gt; 3      °--node_3        </span>
<span class="co">#&gt; 4          ¦--node_4    </span>
<span class="co">#&gt; 5          °--node_5    </span>
<span class="co">#&gt; 6              °--node_6</span></pre></div>
</li>
</ul>
<div id="22-printextract-variables" class="section level4">
<h4 class="hasAnchor">
<a href="#22-printextract-variables" class="anchor"></a>2.2 Print/extract variables</h4>
<p>The variable of an MTG can be printed using the <code><a href="https://rdrr.io/r/base/print.html">print()</a></code> function, <em>e.g.</em>:</p>
<div class="sourceCode" id="cb7"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">MTG</span>$<span class="no">MTG</span>, <span class="st">".symbol"</span>, <span class="st">"Length"</span>)
<span class="co">#&gt;                levelName    .symbol Length</span>
<span class="co">#&gt; 1 node_1                 Individual     NA</span>
<span class="co">#&gt; 2  °--node_2                   Axis     NA</span>
<span class="co">#&gt; 3      °--node_3          Internode      4</span>
<span class="co">#&gt; 4          ¦--node_4           Leaf     10</span>
<span class="co">#&gt; 5          °--node_5      Internode      6</span>
<span class="co">#&gt; 6              °--node_6       Leaf     12</span></pre></div>
<p>The variables can also be extracted in a <code><a href="https://rdrr.io/r/base/data.frame.html">data.frame()</a></code> using the functions from the <code>data.tree</code> package <em>e.g.</em>:</p>
<div class="sourceCode" id="cb8"><pre class="r"><span class="kw pkg">data.tree</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/data.tree/man/as.data.frame.Node.html">ToDataFrameTree</a></span>(<span class="no">MTG</span>$<span class="no">MTG</span>,<span class="st">"Length"</span>,<span class="st">"Width"</span>)
<span class="co">#&gt;                levelName Length Width</span>
<span class="co">#&gt; 1 node_1                     NA    NA</span>
<span class="co">#&gt; 2  °--node_2                 NA    NA</span>
<span class="co">#&gt; 3      °--node_3              4     1</span>
<span class="co">#&gt; 4          ¦--node_4         10     6</span>
<span class="co">#&gt; 5          °--node_5          6    NA</span>
<span class="co">#&gt; 6              °--node_6     12     7</span></pre></div>
</div>
</div>
<div id="23-mutate-the-mtg" class="section level3">
<h3 class="hasAnchor">
<a href="#23-mutate-the-mtg" class="anchor"></a>2.3 Mutate the MTG</h3>
<p>The attributes (also known as features or variables) of the MTG can be mutated using <code><a href="reference/mutate_mtg.html">mutate_mtg()</a></code>. It allows to compute new variables, or modify the existing ones.</p>
<div id="231-compute-new-variables" class="section level4">
<h4 class="hasAnchor">
<a href="#231-compute-new-variables" class="anchor"></a>2.3.1 Compute new variables</h4>
<p><code><a href="reference/mutate_mtg.html">mutate_mtg()</a></code> borrows its syntax from <code>dplyr</code>. We can compute a new variable based on the values of others:</p>
<div class="sourceCode" id="cb9"><pre class="r"><span class="co"># Import the MTG:</span>
<span class="no">filepath</span><span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>, <span class="st">"simple_plant.mtg"</span>, <span class="kw">package</span> <span class="kw">=</span> <span class="st">"XploRer"</span>)
<span class="no">MTG</span> <span class="kw">=</span> <span class="fu"><a href="reference/read_MTG.html">read_mtg</a></span>(<span class="no">filepath</span>)

<span class="co"># And mutate it by adding two new variables, Length2 and Length3:</span>
<span class="fu"><a href="reference/mutate_mtg.html">mutate_mtg</a></span>(<span class="no">MTG</span>, <span class="kw">Length2</span> <span class="kw">=</span> <span class="no">node</span>$<span class="no">Length</span> + <span class="fl">2</span>, <span class="kw">Length3</span> <span class="kw">=</span> <span class="no">node</span>$<span class="no">Length2</span> * <span class="fl">2</span>)</pre></div>
<p>We can note two things here:</p>
<ol>
<li><p>We use <code>node$</code> to access the values of a variable inside the MTG. This is done to avoid any conflicts between variables from the MTG, and variables from your environment;</p></li>
<li><p><code>Length3</code> uses the results of <code>Length2</code> before it even exist. This is very powerful to construct many new variables at once. It is allowed thanks to a sequential construction of the variables.</p></li>
</ol>
<p>As with <code>dplyr</code> main functions, <code><a href="reference/mutate_mtg.html">mutate_mtg()</a></code> can be used with pipes:</p>
<div class="sourceCode" id="cb10"><pre class="r"><span class="fu"><a href="reference/read_MTG.html">read_mtg</a></span>(<span class="no">filepath</span>)<span class="kw">%&gt;%</span>
  <span class="fu"><a href="reference/mutate_mtg.html">mutate_mtg</a></span>(<span class="kw">Length2</span> <span class="kw">=</span> <span class="no">node</span>$<span class="no">Length</span> + <span class="fl">2</span>)</pre></div>
<p>This is allowed because the function returns the results invisibly. Note that it is mutating the MTG in place though, so no need to assign the results of <code><a href="reference/mutate_mtg.html">mutate_mtg()</a></code> to a variable.</p>
</div>
<div id="232-using-parent-values" class="section level4">
<h4 class="hasAnchor">
<a href="#232-using-parent-values" class="anchor"></a>2.3.2 Using parent values</h4>
<p>You can also use functions inside the call of the function. Some helpers are provided by the package to compute variables based on the ancestors or children of the node (see <code><a href="reference/get_parent_value.html">get_parent_value()</a></code>, <code><a href="reference/get_children_values.html">get_children_values()</a></code> and <code><a href="reference/get_ancestors_values.html">get_ancestors_values()</a></code>). Here is an example were we define a new variable called <code>Length_parent</code> that is the length of the node’s parent:</p>
<div class="sourceCode" id="cb11"><pre class="r"><span class="fu"><a href="reference/mutate_mtg.html">mutate_mtg</a></span>(<span class="no">MTG</span>, <span class="kw">Length_parent</span> <span class="kw">=</span> <span class="fu"><a href="reference/get_parent_value.html">get_parent_value</a></span>(<span class="st">"Length"</span>))</pre></div>
<p><code><a href="reference/get_parent_value.html">get_parent_value()</a></code> is used to get the value of the “Length” variable from the parent of each node.</p>
<p>If we need the values of all ancestors of a node along the tree, we can use <code><a href="reference/get_ancestors_values.html">get_ancestors_values()</a></code> instead:</p>
<div class="sourceCode" id="cb12"><pre class="r"><span class="fu"><a href="reference/mutate_mtg.html">mutate_mtg</a></span>(<span class="no">MTG</span>, <span class="kw">total_length</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="fu"><a href="reference/get_ancestors_values.html">get_ancestors_values</a></span>(<span class="st">"Length"</span>,<span class="kw">self</span> <span class="kw">=</span> <span class="fl">TRUE</span>),<span class="kw">na.rm</span> <span class="kw">=</span> <span class="fl">TRUE</span>))</pre></div>
<p>Here are the results for both:</p>
<div class="sourceCode" id="cb13"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">MTG</span>$<span class="no">MTG</span>,<span class="st">".symbol"</span>,<span class="st">"Length"</span>,<span class="st">"Length_parent"</span>,<span class="st">"total_length"</span>)
<span class="co">#&gt;                levelName    .symbol Length Length_parent total_length</span>
<span class="co">#&gt; 1 node_1                 Individual     NA            NA            0</span>
<span class="co">#&gt; 2  °--node_2                   Axis     NA            NA            0</span>
<span class="co">#&gt; 3      °--node_3          Internode      4            NA            4</span>
<span class="co">#&gt; 4          ¦--node_4           Leaf     10             4           14</span>
<span class="co">#&gt; 5          °--node_5      Internode      6             4           10</span>
<span class="co">#&gt; 6              °--node_6       Leaf     12             6           22</span></pre></div>
</div>
<div id="233-using-children-values" class="section level4">
<h4 class="hasAnchor">
<a href="#233-using-children-values" class="anchor"></a>2.3.3 Using children values</h4>
<p>To get the children values of a node, use <code><a href="reference/get_children_values.html">get_children_values()</a></code>. This function returns the values of a field for all children of a node:</p>
<div class="sourceCode" id="cb14"><pre class="r"><span class="fu"><a href="reference/get_children_values.html">get_children_values</a></span>(<span class="kw">attribute</span> <span class="kw">=</span> <span class="st">"Length"</span>, <span class="kw">node</span> <span class="kw">=</span> <span class="kw pkg">data.tree</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/data.tree/man/FindNode.html">FindNode</a></span>(<span class="no">MTG</span>$<span class="no">MTG</span>, <span class="st">"node_3"</span>))
<span class="co">#&gt; node_4 node_5 </span>
<span class="co">#&gt;     10      6</span></pre></div>
<p>It can be used to get <em>e.g.</em> the average length of the children:</p>
<div class="sourceCode" id="cb15"><pre class="r"><span class="fu"><a href="reference/mutate_mtg.html">mutate_mtg</a></span>(<span class="no">MTG</span>, <span class="kw">children_length</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="fu"><a href="reference/get_children_values.html">get_children_values</a></span>(<span class="st">"Length"</span>), <span class="kw">na.rm</span> <span class="kw">=</span> <span class="fl">TRUE</span>))
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">MTG</span>$<span class="no">MTG</span>, <span class="st">".symbol"</span>, <span class="st">"Length"</span>,<span class="st">"children_length"</span>)
<span class="co">#&gt;                levelName    .symbol Length children_length</span>
<span class="co">#&gt; 1 node_1                 Individual     NA             NaN</span>
<span class="co">#&gt; 2  °--node_2                   Axis     NA               4</span>
<span class="co">#&gt; 3      °--node_3          Internode      4               8</span>
<span class="co">#&gt; 4          ¦--node_4           Leaf     10             NaN</span>
<span class="co">#&gt; 5          °--node_5      Internode      6              12</span>
<span class="co">#&gt; 6              °--node_6       Leaf     12             NaN</span></pre></div>
</div>
<div id="224-combine-values" class="section level4">
<h4 class="hasAnchor">
<a href="#224-combine-values" class="anchor"></a>2.2.4 Combine values</h4>
<p>We can also make more complex associations. Here is an example were we need the sum of the surface of the section of all children for the nodes, but only for the nodes of scale “S”:</p>
<div class="sourceCode" id="cb16"><pre class="r"><span class="fu"><a href="reference/mutate_mtg.html">mutate_mtg</a></span>(<span class="no">MTG</span>, <span class="kw">section_surface</span> <span class="kw">=</span> <span class="no">pi</span> * ((<span class="no">node</span>$<span class="no">Width</span> / <span class="fl">2</span>)^<span class="fl">2</span>),
           <span class="kw">s_surf_child_sum</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span>(<span class="fu"><a href="reference/get_children_values.html">get_children_values</a></span>(<span class="st">"section_surface"</span>,<span class="kw">scale</span> <span class="kw">=</span> <span class="st">"S"</span>),<span class="kw">na.rm</span><span class="kw">=</span><span class="fl">TRUE</span>))</pre></div>
<p>We first compute the surface of the section of each node, and then we sum the values for all children of the nodes. This is helpful to check if our MTG follows the pipe model.</p>
</div>
<div id="225-filter-by-scale" class="section level4">
<h4 class="hasAnchor">
<a href="#225-filter-by-scale" class="anchor"></a>2.2.5 Filter by scale</h4>
<p>We can also filter the parent by scale, <em>i.e.</em> the name of the SYMBOL from the MTG classes, which corresponds to the <code>.symbol</code> value in the node.</p>
<p>To get the possible values for the SYMBOLS in an MTG:</p>
<div class="sourceCode" id="cb17"><pre class="r"><span class="no">MTG</span>$<span class="no">classes</span>$<span class="no">SYMBOL</span>
<span class="co">#&gt; [1] "$"          "Internode"  "Individual" "Leaf"       "Axis"</span></pre></div>
<p>To get the symbol of a node use the <code>.symbol</code> field on a node:</p>
<div class="sourceCode" id="cb18"><pre class="r"><span class="no">MTG</span>$<span class="no">MTG</span>$<span class="no">.symbol</span>
<span class="co">#&gt; [1] "Individual"</span></pre></div>
<p>To filter the parent node by its scale, use the <code>scale</code> argument:</p>
<div class="sourceCode" id="cb19"><pre class="r"><span class="fu"><a href="reference/get_parent_value.html">get_parent_value</a></span>(<span class="kw">attribute</span> <span class="kw">=</span> <span class="st">"Length"</span>, <span class="kw">node</span> <span class="kw">=</span> <span class="kw pkg">data.tree</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/data.tree/man/FindNode.html">FindNode</a></span>(<span class="no">MTG</span>$<span class="no">MTG</span>, <span class="st">"node_6"</span>), <span class="kw">scale</span> <span class="kw">=</span> <span class="st">"Axis"</span>)
<span class="co">#&gt; [1] NA</span></pre></div>
<p>Here it returns <code>NA</code> because the first parent is an <code>Internode</code>, and the first node with scale “Axis” (<code>node_2</code>) has no values for “Length”, see by yourself:</p>
<div class="sourceCode" id="cb20"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">MTG</span>$<span class="no">MTG</span>, <span class="st">".symbol"</span>, <span class="st">"Length"</span>)
<span class="co">#&gt;                levelName    .symbol Length</span>
<span class="co">#&gt; 1 node_1                 Individual     NA</span>
<span class="co">#&gt; 2  °--node_2                   Axis     NA</span>
<span class="co">#&gt; 3      °--node_3          Internode      4</span>
<span class="co">#&gt; 4          ¦--node_4           Leaf     10</span>
<span class="co">#&gt; 5          °--node_5      Internode      6</span>
<span class="co">#&gt; 6              °--node_6       Leaf     12</span></pre></div>
<p>Several functions implements their own way to deal with scales. <code><a href="reference/get_parent_value.html">get_parent_value()</a></code>, <code><a href="reference/get_ancestors_values.html">get_ancestors_values()</a></code> and <code><a href="reference/get_children_values.html">get_children_values()</a></code> all share a <code>scale</code> argument to filter the parents by scale. By default, the function will return the values from the first ancestor with the required scale by “climbing” the tree from one node to the other (starting from the node of interest). If none of the ancestors are of the required scale, then the function returns <code>NA</code>.</p>
<p>The <code>recursive</code> argument can be used in <code><a href="reference/get_parent_value.html">get_parent_value()</a></code> and <code><a href="reference/get_children_values.html">get_children_values()</a></code> functions to disable this default behavior of “climbing”, so the function will return <code>NA</code> if the first parent is not of the right scale.</p>
<p>Here is an example with recursive behavior:</p>
<div class="sourceCode" id="cb21"><pre class="r"><span class="fu"><a href="reference/get_children_values.html">get_children_values</a></span>(<span class="kw">attribute</span> <span class="kw">=</span> <span class="st">"Length"</span>, <span class="kw">node</span> <span class="kw">=</span> <span class="no">MTG</span>$<span class="no">MTG</span>$<span class="no">node_2</span>, <span class="kw">scale</span> <span class="kw">=</span> <span class="st">"Leaf"</span>)
<span class="co">#&gt; node_4 node_6 </span>
<span class="co">#&gt;     10     12</span></pre></div>
<p>And without:</p>
<div class="sourceCode" id="cb22"><pre class="r"><span class="fu"><a href="reference/get_children_values.html">get_children_values</a></span>(<span class="kw">attribute</span> <span class="kw">=</span> <span class="st">"Length"</span>, <span class="kw">node</span> <span class="kw">=</span> <span class="no">MTG</span>$<span class="no">MTG</span>$<span class="no">node_2</span>, <span class="kw">scale</span> <span class="kw">=</span> <span class="st">"Leaf"</span>, <span class="kw">recursive</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="co">#&gt; [1] NA</span></pre></div>
<p>Here it returns <code>NA</code> because “node_2” has one child (“node_3”) that is not of the right scale, but <code>recursive = FALSE</code> so the function just returns <code>NA</code>.</p>
<blockquote>
<p>Note that <code><a href="reference/get_ancestors_values.html">get_ancestors_values()</a></code> does not have the <code>recursive</code> argument because it is a recursive function by design. So if an ancestor is not of the right scale, it just passes to the next ancestor.</p>
</blockquote>
<p><code><a href="reference/mutate_mtg.html">mutate_mtg()</a></code> has a <code>.scale</code> argument that is used similarly to the <code>scale</code> argument of the other functions. The only difference is that the functions inside a <code><a href="reference/mutate_mtg.html">mutate_mtg()</a></code> call will only be applied to the nodes of the chosen scales, but once the function called, it will still have access to the node parents and children if needed. Furthermore, the <code>.scale</code> argument is applied to all functions inside the <code><a href="reference/mutate_mtg.html">mutate_mtg()</a></code> call.</p>
<p>The advantage is we can combine the <code>.scale</code> argument from <code><a href="reference/mutate_mtg.html">mutate_mtg()</a></code> and then the <code>scale</code> argument from the other functions in a single call. If you need a computation at one scale for a variable but at another scale for another, it is preferable to use multiple calls to <code><a href="reference/mutate_mtg.html">mutate_mtg()</a></code>, possibly chained using a pipe, <em>e.g.</em>:</p>
<div class="sourceCode" id="cb23"><pre class="r"><span class="fu"><a href="reference/mutate_mtg.html">mutate_mtg</a></span>(<span class="no">MTG</span>, <span class="kw">section_surface</span> <span class="kw">=</span> <span class="no">pi</span> * ((<span class="no">node</span>$<span class="no">Width</span> / <span class="fl">2</span>)^<span class="fl">2</span>),
          <span class="kw">.scale</span> <span class="kw">=</span> <span class="st">"Internode"</span>)<span class="kw">%&gt;%</span>
<span class="fu"><a href="reference/mutate_mtg.html">mutate_mtg</a></span>(<span class="kw">area</span> <span class="kw">=</span> <span class="no">node</span>$<span class="no">Width</span> * <span class="no">node</span>$<span class="no">Length</span>, <span class="kw">.scale</span> <span class="kw">=</span> <span class="st">"Leaf"</span>)

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="no">MTG</span>$<span class="no">MTG</span>, <span class="st">".symbol"</span>, <span class="st">"Width"</span>,<span class="st">"section_surface"</span>, <span class="st">"area"</span>)
<span class="co">#&gt;                levelName    .symbol Width section_surface area</span>
<span class="co">#&gt; 1 node_1                 Individual    NA              NA   NA</span>
<span class="co">#&gt; 2  °--node_2                   Axis    NA              NA   NA</span>
<span class="co">#&gt; 3      °--node_3          Internode     1       0.7853982   NA</span>
<span class="co">#&gt; 4          ¦--node_4           Leaf     6      28.2743339   60</span>
<span class="co">#&gt; 5          °--node_5      Internode    NA              NA   NA</span>
<span class="co">#&gt; 6              °--node_6       Leaf     7      38.4845100   84</span></pre></div>
</div>
</div>
<div id="23-plotting-a-plant" class="section level3">
<h3 class="hasAnchor">
<a href="#23-plotting-a-plant" class="anchor"></a>2.3 Plotting a plant</h3>
<div id="231-static-plot" class="section level4">
<h4 class="hasAnchor">
<a href="#231-static-plot" class="anchor"></a>2.3.1 Static plot</h4>
<p>The plant topology can be plotted using the <code><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot()</a></code> function. This function is implemented by <code>ggplot2</code> so you’ll need to load this package before-hand:</p>
<div class="sourceCode" id="cb24"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)
<span class="co">#&gt; Warning: package 'ggplot2' was built under R version 3.6.3</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span>(<span class="no">MTG</span>)</pre></div>
<p><img src="reference/figures/README-unnamed-chunk-23-1.png" width="100%"></p>
<p>The function can be used in a pipe, such as:</p>
<div class="sourceCode" id="cb25"><pre class="r"><span class="fu"><a href="reference/read_MTG.html">read_mtg</a></span>(<span class="no">filepath</span>)<span class="kw">%&gt;%</span>
  <span class="fu"><a href="reference/mutate_mtg.html">mutate_mtg</a></span>(<span class="kw">Length2</span> <span class="kw">=</span> <span class="no">node</span>$<span class="no">Length</span> + <span class="fl">2</span>)<span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span>(<span class="no">.</span>)</pre></div>
</div>
<div id="232-interactive-plot" class="section level4">
<h4 class="hasAnchor">
<a href="#232-interactive-plot" class="anchor"></a>2.3.2 Interactive plot</h4>
<p>The same plot can be rendered as an interactive plot using:</p>
<div class="sourceCode" id="cb26"><pre class="r"><span class="fu">plotly_MTG</span>(<span class="no">MTG</span>)</pre></div>
<p><img src="https://raw.githubusercontent.com/VEZY/XploRer/master/www/plotly_MTG.gif" alt="Interactive plot"></p>
<p><code>plotly_MTG()</code> uses the <a href="https://plotly.com/">plotly API</a> under the hood.</p>
<p>It is also possible to add any variable in the tooltip appearing on hover of a node by adding it to the call. For example if we need the <code>Length</code> and the <code>Width</code> of the nodes, we would write:</p>
<div class="sourceCode" id="cb27"><pre class="r"><span class="fu"><a href="reference/plotly_MTG.html">plotly_mtg</a></span>(<span class="no">MTG</span>, <span class="no">Length</span>, <span class="no">Width</span>)</pre></div>
</div>
</div>
</div>
<div id="3-help" class="section level2">
<h2 class="hasAnchor">
<a href="#3-help" class="anchor"></a>3. Help</h2>
<p>Please see the <a href="http://openalea.gforge.inria.fr/doc/vplants/newmtg/doc/_build/html/contents.html">OpenAlea documentation</a> (especially chapter 8) for more details on the MTG files.</p>
<p>If you have any other problem related to the package, please feel free to <a href="https://github.com/VEZY/XploRer/issues">fill an issue</a> on Github.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Remi Vezy <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-0808-1461" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://www.repostatus.org/#wip"><img src="https://www.repostatus.org/badges/latest/wip.svg" alt="Project Status: WIP – Initial development is in progress, but there has not yet been a stable, usable release suitable for the public."></a></li>
<li><a href="https://github.com/VEZY/XploRer/actions"><img src="https://github.com/VEZY/XploRer/workflows/R-CMD-check/badge.svg" alt="R build status"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Remi Vezy.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
